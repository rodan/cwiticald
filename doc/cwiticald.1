.\" Process this file with
.\" groff -man -Tascii foo.1
.\"
.TH cwiticald 1 "NOVEMBER 2021"
.SH NAME
cwiticald \- an entropy gathering daemon that provides a stream of random bytes generated by a USB TrueRNG device via TCP

.SH SYNOPSIS
.B cwiticald [-hv] [-d, --device
.I NAME
.B ] [-4, --ipv4
.I IP
.B ] [-6, --ipv6
.I IP
.B ] [-p, --port
.I NUM
.B ] [-b, --buffer-size
.I NUM
.B ] [-t, --trigger
.I NUM
.B ]
.SH DESCRIPTION
.B cwiticald
reads blocks of 2500 bytes from
.I /dev/truerng
verifies their compliance against FIPS 140-1 and FIPS 140-2 tests, fills up a large buffer and provides it to clients that connect to it via TCPv4 or TCPv6.

The application does not need root priviledges or write access to any file in order to run. /dev/ttyACMx (the TrueRNG USB device) needs to be readable by the user/group cwiticald runs as.

an ekey-egd-linux service can be used as client to 
.B cwiticald
:

ekey-egd-linux -H 
.I cwiticald-server
-p 41300 -b 2 -r 10

.SH OPTIONS
.IP -h
Display short help message and exit
.IP -v
Display application version
.IP "-d, --device"
provide an entropy generator that will be read instead of 
.I /dev/truerng

the truerng device is usually created by an udev rule like the one below:

.EX
# ubld.it TrueRNG
#
# This rule creates a symlin to newly attached CDC-ACM device 
# Also includes fix for wrong termios settings on some linux kernels
SUBSYSTEM=="tty", ATTRS{product}=="TrueRNG", MODE="0640", GROUP="rngd", SYMLINK+="truerng", RUN+="/bin/stty raw -echo -ixoff -F /dev/%k speed 3000000"
ATTRS{idVendor}=="04d8", ATTRS{idProduct}=="f5fe", ENV{ID_MM_DEVICE_IGNORE}="1"
.EE

one might need to tweak the USB Vendor, Product ID and the group ownership.

default value is 
.B /dev/truerng

.IP "-4, --ipv4=IP"
IPv4 address to bind to.

default value is 
.B 127.0.0.1

.IP "-6, --ipv6=IP"
IPv6 address to bind to. If this option is requested then the daemon will not bind to any IPv4 ip.

default value is 
.B ''

.IP "-p, --port=NUM"
tcp port to bind to.

default value is 
.B 41300

.IP "-b, --buffer-size=NUM"
size in bytes of the buffer used for storing entropy.

default value is 
.B 500000

.IP "-t, --trigger=NUM"
at what entropy availability level should the program fill up the buffer

default value is 
.B 450000

.SH DIAGNOSTICS
errors are generated on stderr if any of the system calls returns a failure.
 
.SH BUGS
please report any bugs via the github tracker located at <https://github.com/rodan/cwiticald/issues>
.SH "LICENSE"
.B cwiticald
is covered by the GNU General Public License (GPLv3 or later).
.SH AUTHOR
Petre Rodan <2b4eda@subdimension.ro>
.SH "SEE ALSO"
.BR ekey-egd-linux (8)
,
.BR stunnel (8)
